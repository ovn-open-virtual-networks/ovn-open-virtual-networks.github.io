<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
   <meta name="description" content="核心监控

系统指标是评价系统健康程度的重要标准；指标可以分为：功能指标，性能指标等



指标

异常指标：最直观体现系统健康状态，功能状态；异常指标监控（不可用，重启，panic等），必要错误日志。
性能指标：反应系统压力状态，性能表现；具体指标如响应时间、吞吐量、并发性、可扩展性、容错能力、安全性。
可靠性指标：反映了软件的稳定性和可靠性，包括软件的错误率、崩溃率、失效率等。
资源利用率：包括 CPU 利用率、内存利用率、磁盘利用率等，反映了软件使用系统资源的效率。



感知

监控：反应基础服务总体情况，根据总体情况可以快速定位到局部问题，因此大盘集群维度监控必不可少。
告警：需要对告警进行分级，核心重要报警必须及时处理止损，避免线上问题扩延；提供告警升级机制，如大批量低优先级的告警自动升级到高优先级。
值班：oncall 不仅仅是SRE的职责，也是研发同学必备的工作；轮流值班能确保对线上问题被处理，具体形式可以分为主备。




预案是止损的重要核心手段，定位到对应故障后应执行对应预案，如果手忙脚乱现场止损往往很可能浪费了很多宝贵时间，且没有达到预期效果，甚至导致二次故障。


预案

SOP预案: 针对可能的故障场景，需要从不同的维度思考，提前准备好止损预案。
故障自愈: 更一步可以将预案作为自愈执行，实现故障的自愈。
故障注入: 因为系统软件功能都是在不断迭代更新，故障预案在日常工作中很容易被忽略或者逐渐失效腐化。为保障预案的有效性，可通过放火平台进行验证。


止损

先止损: 降级，限流，熔断，恢复
排查潜在风险
短期解决方案
长期解决方案



故障分类

线上变更：故障绝大部分是由于变更导致的；因此线上必须遵循变更军规，必须有审批，灰度，回滚等
配置问题：超时、阈值设置不合理，环境变量错误
代码编写：代码逻辑问题，或者第三方库，场景思考不全面，代码性能
系统设计：系统间循环依赖，服务雪崩，流量突增（运营活动流量，高峰流量，攻击流量），可扩张性差
系统过载：CPU，内存，磁盘，线程池，连接池等资源不足
自然故障：路由器，网线等网络问题，服务器宕机，第三方服务故障，机房不可用
容量评估

系统设计

方案评审

评审原则，不同方案对比，最终方案优劣势。行业最佳实践
资源占用，限制手段
周边依赖
故障处理

系统异常
流量突增
降级
限流
熔断




代码评审

CI
CR


软件测试

单元
集成
冒烟
回归
性能
压力
稳定性
金丝雀发布


上线流程

军规


过载保护
强健的系统需要优雅地处理过载情况。过载保护主要是为了提升用户体验，保障服务质量，在发生突发流量时仍然能够提供一部分服务能力，而不是整个系统瘫痪。过载保护策略优先级，降级，限流，扩容，切流。其次评估系统容量，提前扩容以及事中快速自动化扩容、多活切流都是解决系统过载的方法。

日常机制

复盘机制：对出过的线上事故一定要及时的进行复盘，通过复盘来发现我们现有流程、机制、潜在风险是否有问题。复盘虽属于事后行为，但很重要，我们需要通过复盘来看下次是否能预防此故障，或者是否能更快的定位和止损。
稳定性周会、稳定性月会：我们通过各种定期的会议来总结一些阶段性进展和成果，拉齐大家认知，这也是大伙日常稳定性工作露出的一个机会，所以非常重要。
">  

  <title>
    
      2025-01-10 基础设施稳定性建设概要
    
  </title>

  <link rel="shortcut icon" type="image/x-icon" href="/" />
  
  
  
  <link rel="stylesheet" href="/css/main.1fa58ff16f0777b464d699b5c7e5a7c05cc1cd9eb0840933fd40d4746f8dce721f5f64332253b98956db52463f2a7d1eada99b7e3fa9ff181df0c6384dff7904.css" integrity="sha512-H6WP8W8Hd7Rk1pm1x&#43;WnwFzBzZ6whAkz/UDUdG&#43;NznIfX2QzIlO5iVbbUkY/Kn0erambfj&#43;p/xgd8MY4Tf95BA==" />
  
  
</head>
<body a="auto">
        <main class="page-content" aria-label="Content">
            <div class="w">
                <div class="post-meta">
                    <a href="/">..</a>

                    <p>
                        <time datetime="2025-01-10 06:19:48 -0500 EST">
                            2025-01-10
                        </time>
                    </p>
                </div>

<article>
    <h1>2025-01-10 基础设施稳定性建设概要</h1>

    

    <h2 id="核心监控">核心监控</h2>
<blockquote>
<p>系统指标是评价系统健康程度的重要标准；指标可以分为：功能指标，性能指标等</p>
</blockquote>
<ul>
<li>
<p>指标</p>
<ul>
<li>异常指标：最直观体现系统健康状态，功能状态；异常指标监控（不可用，重启，panic等），必要错误日志。</li>
<li>性能指标：反应系统压力状态，性能表现；具体指标如响应时间、吞吐量、并发性、可扩展性、容错能力、安全性。</li>
<li>可靠性指标：反映了软件的稳定性和可靠性，包括软件的错误率、崩溃率、失效率等。</li>
<li>资源利用率：包括 CPU 利用率、内存利用率、磁盘利用率等，反映了软件使用系统资源的效率。</li>
</ul>
</li>
<li>
<p>感知</p>
<ul>
<li>监控：反应基础服务总体情况，根据总体情况可以快速定位到局部问题，因此大盘集群维度监控必不可少。</li>
<li>告警：需要对告警进行分级，核心重要报警必须及时处理止损，避免线上问题扩延；提供告警升级机制，如大批量低优先级的告警自动升级到高优先级。</li>
<li>值班：oncall 不仅仅是SRE的职责，也是研发同学必备的工作；轮流值班能确保对线上问题被处理，具体形式可以分为主备。</li>
</ul>
</li>
</ul>
<blockquote>
<p>预案是止损的重要核心手段，定位到对应故障后应执行对应预案，如果手忙脚乱现场止损往往很可能浪费了很多宝贵时间，且没有达到预期效果，甚至导致二次故障。</p>
</blockquote>
<ul>
<li>预案
<ul>
<li>SOP预案: 针对可能的故障场景，需要从不同的维度思考，提前准备好止损预案。</li>
<li>故障自愈: 更一步可以将预案作为自愈执行，实现故障的自愈。</li>
<li>故障注入: 因为系统软件功能都是在不断迭代更新，故障预案在日常工作中很容易被忽略或者逐渐失效腐化。为保障预案的有效性，可通过放火平台进行验证。</li>
</ul>
</li>
<li>止损
<ul>
<li>先止损: 降级，限流，熔断，恢复</li>
<li>排查潜在风险</li>
<li>短期解决方案</li>
<li>长期解决方案</li>
</ul>
</li>
</ul>
<h2 id="故障分类">故障分类</h2>
<ul>
<li>线上变更：故障绝大部分是由于变更导致的；因此线上必须遵循变更军规，必须有审批，灰度，回滚等</li>
<li>配置问题：超时、阈值设置不合理，环境变量错误</li>
<li>代码编写：代码逻辑问题，或者第三方库，场景思考不全面，代码性能</li>
<li>系统设计：系统间循环依赖，服务雪崩，流量突增（运营活动流量，高峰流量，攻击流量），可扩张性差</li>
<li>系统过载：CPU，内存，磁盘，线程池，连接池等资源不足</li>
<li>自然故障：路由器，网线等网络问题，服务器宕机，第三方服务故障，机房不可用</li>
<li>容量评估</li>
</ul>
<h2 id="系统设计">系统设计</h2>
<ul>
<li>方案评审
<ul>
<li>评审原则，不同方案对比，最终方案优劣势。行业最佳实践</li>
<li>资源占用，限制手段</li>
<li>周边依赖</li>
<li>故障处理
<ul>
<li>系统异常</li>
<li>流量突增</li>
<li>降级</li>
<li>限流</li>
<li>熔断</li>
</ul>
</li>
</ul>
</li>
<li>代码评审
<ul>
<li>CI</li>
<li>CR</li>
</ul>
</li>
<li>软件测试
<ul>
<li>单元</li>
<li>集成</li>
<li>冒烟</li>
<li>回归</li>
<li>性能</li>
<li>压力</li>
<li>稳定性</li>
<li>金丝雀发布</li>
</ul>
</li>
<li>上线流程
<ul>
<li>军规</li>
</ul>
</li>
<li><strong>过载保护</strong>
强健的系统需要优雅地处理过载情况。过载保护主要是为了提升用户体验，保障服务质量，在发生突发流量时仍然能够提供一部分服务能力，而不是整个系统瘫痪。过载保护策略优先级，降级，限流，扩容，切流。其次评估系统容量，提前扩容以及事中快速自动化扩容、多活切流都是解决系统过载的方法。</li>
</ul>
<h2 id="日常机制">日常机制</h2>
<ul>
<li>复盘机制：对出过的线上事故一定要及时的进行复盘，通过复盘来发现我们现有流程、机制、潜在风险是否有问题。复盘虽属于事后行为，但很重要，我们需要通过复盘来看下次是否能预防此故障，或者是否能更快的定位和止损。</li>
<li>稳定性周会、稳定性月会：我们通过各种定期的会议来总结一些阶段性进展和成果，拉齐大家认知，这也是大伙日常稳定性工作露出的一个机会，所以非常重要。</li>
</ul>

</article>
<div class="postlink">
	<p><strong>本文链接地址: </strong><a href="">《2025-01-10 基础设施稳定性建设概要》</a><p>
</div>
</div>
        </main>
    </body></html>
